# Semantic Segmentation System for Geological Well Logs

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑—Ä–µ–∑–æ–≤ —Å–∫–≤–∞–∂–∏–Ω, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –¥–ª–∏–Ω–Ω—ã—Ö –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä–æ—Ç–∞–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è 40 —Ç–∏–ø–æ–≤ –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ä–æ–¥ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è –≤ —Ä–∞–∑—Ä–µ–∑–∞—Ö, —Å –¥–∞–ª—å–Ω–µ–π—à–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∑–∞–¥–∞—á–∞—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

–í –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ–Ω–∏—è –ª–µ–∂–∏—Ç –º–æ–¥–µ–ª—å DeepLabV3+ —Å backbone ResNet50. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ –∑–∞–¥–∞—á—É:

–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω—ã—Ö –º–∞—Å–∫–∞—Ö, –≥–¥–µ –∫–∞–∂–¥—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º—É –∫–ª–∞—Å—Å—É;

–∏–Ω—Ñ–µ—Ä–µ–Ω—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π GPU-–ø–∞–º—è—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–∞–¥–¥–∏–Ω–≥ –¥–æ –∫—Ä–∞—Ç–Ω–æ—Å—Ç–∏ 16);

–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Test-Time Augmentation (4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ñ–ª–∏–ø–æ–≤) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π;

–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–º–µ—Ç–∫–∏ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü), –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Å–Ω–∏–∑–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–∞ —É–∑–∫–∏—Ö –ø—Ä–æ—Å–ª–æ–π–∫–∞—Ö —Å–ª–æ—ë–≤.

–ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç IoU = 0.948 –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–º —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω–æ–º—É –∫–∞—á–µ—Å—Ç–≤—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤ —Ä–∞–Ω–Ω–µ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≥–µ–æ–ª–æ–≥–æ–≤.

---

## –ü—Ä–∏–º–µ—Ä

| Input | Segmentation |
|-------|--------------|
| <img src="examples/0.png" width="300"/> | <img src="examples/0_pr.png" width="300"/> |


## –°—Ç–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞

- **PyTorch**
- **segmentation-models-pytorch (DeepLabV3+)**
- **timm**
- **Albumentations**
- **OpenCV**
- **NumPy / Pillow**
- **Kaggle Notebooks / Google Colab**


---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```text
wells_segmentation/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train_images/        # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (train)
‚îÇ   ‚îú‚îÄ‚îÄ train_masks/         # –º–∞—Å–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (train)
‚îÇ   ‚îú‚îÄ‚îÄ val_images/          # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (val)
‚îÇ   ‚îú‚îÄ‚îÄ val_masks/           # –º–∞—Å–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (val)
‚îÇ   ‚îî‚îÄ‚îÄ test_images/         # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ / —Ç–µ—Å—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ work/
‚îÇ   ‚îú‚îÄ‚îÄ weights/             # —Å—é–¥–∞ –∫–ª–∞—Å—Ç—å seg_best.pt (–≤ —Ä–µ–ø–æ –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ runs/                # –º–∞—Å–∫–∏ –ø–æ—Å–ª–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ infer_seg.py         # —Å–∫—Ä–∏–ø—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ train_seg.py         # —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```


## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
git clone https://github.com/<your-username>/wells-segmentation.git
cd wells-segmentation

python3 -m venv .venv
source .venv/bin/activate      # Windows: .venv\Scripts\activate

pip install -r requirements.txt
```

---

## –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏

–§–∞–π–ª –≤–µ—Å–æ–≤ **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**  
–°–∫–∞—á–∞–π—Ç–µ `seg_best.pt` –ø–æ —Å—Å—ã–ª–∫–µ (https://drive.google.com/drive/folders/1GwC-4JUy53NoRdtl9XR2AZSEdwjQx89R?usp=sharing) –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤:

```text
work/weights/seg_best.pt
```

–ü—Ä–∏–º–µ—Ä:

```bash
mkdir -p work/weights
# —Å–∫–∞—á–∞–π—Ç–µ seg_best.pt –∏ –ø–æ–ª–æ–∂–∏—Ç–µ –≤ work/weights –≤—Ä—É—á–Ω—É—é
```

---

## Inference (–∑–∞–ø—É—Å–∫ –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏)

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (`.png`) –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤:

```text
data/test_images/
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å:

```bash
python src/infer_seg.py
```

3. –ì–æ—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤:

```text
work/runs/
```

4. –°–∫—Ä–∏–ø—Ç —Ç–∞–∫–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç –∞—Ä—Ö–∏–≤ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏:

```text
predict_target.zip
```

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:

```text
data/
‚îú‚îÄ‚îÄ train_images/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ train_masks/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ val_images/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ val_masks/
    ‚îú‚îÄ‚îÄ 0.png
    ‚îú‚îÄ‚îÄ 1.png
    ‚îî‚îÄ‚îÄ ...
```

- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≤ `train_images` –∏ `train_masks` –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123.png` –∏ —Ç–∞–º, –∏ —Ç–∞–º).  
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è `val_images` / `val_masks`.  
- –ú–∞—Å–∫–∏ ‚Äî –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω—ã–µ (`uint8`), –≥–¥–µ –ø–∏–∫—Å–µ–ª–∏ = –∏–Ω–¥–µ–∫—Å—ã –∫–ª–∞—Å—Å–æ–≤ –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ.

---

## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:

```bash
python src/train_seg.py
```

–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±—É—á–µ–Ω–∏—è:

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/train_images`, `data/train_masks`, `data/val_images`, `data/val_masks`
- –°—Ç—Ä–æ–∏—Ç –º–æ–¥–µ–ª—å **DeepLabV3+ (ResNet50)** —á–µ—Ä–µ–∑ `segmentation-models-pytorch`
- –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω CUDA)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç –ø–æ –º–µ—Ç—Ä–∏–∫–µ IoU –≤:

```text
work/weights/seg_best.pt
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —á–µ—Ä–µ–∑ `src/infer_seg.py`.

---


