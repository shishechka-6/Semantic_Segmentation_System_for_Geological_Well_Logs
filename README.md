# Semantic Segmentation System for Geological Well Logs

–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑—Ä–µ–∑–æ–≤ —Å–∫–≤–∞–∂–∏–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ DeepLabV3+ (ResNet50).  
–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ 40 –∫–ª–∞—Å—Å–∞—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TTA –∏ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫—É.  
–¢–æ—á–Ω–æ—Å—Ç—å: **IoU = 0.948** –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

---

## üß∞ –°—Ç–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞

- **PyTorch**
- **segmentation-models-pytorch (DeepLabV3+)**
- **timm**
- **Albumentations**
- **OpenCV**
- **NumPy / Pillow**
- **Kaggle Notebooks / Google Colab**


---

## üìÇ Project Structure

```text
wells_segmentation/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train_images/        # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (train)
‚îÇ   ‚îú‚îÄ‚îÄ train_masks/         # –º–∞—Å–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (train)
‚îÇ   ‚îú‚îÄ‚îÄ val_images/          # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (val)
‚îÇ   ‚îú‚îÄ‚îÄ val_masks/           # –º–∞—Å–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (val)
‚îÇ   ‚îî‚îÄ‚îÄ test_images/         # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ / —Ç–µ—Å—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ work/
‚îÇ   ‚îú‚îÄ‚îÄ weights/             # —Å—é–¥–∞ –∫–ª–∞—Å—Ç—å seg_best.pt (–≤ —Ä–µ–ø–æ –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ runs/                # –º–∞—Å–∫–∏ –ø–æ—Å–ª–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ infer_seg.py         # —Å–∫—Ä–∏–ø—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ train_seg.py         # —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```


## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
git clone https://github.com/<your-username>/wells-segmentation.git
cd wells-segmentation

python3 -m venv .venv
source .venv/bin/activate      # Windows: .venv\Scripts\activate

pip install -r requirements.txt
```

---

## üì• –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏

–§–∞–π–ª –≤–µ—Å–æ–≤ **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**  
–°–∫–∞—á–∞–π—Ç–µ `seg_best.pt` –ø–æ —Å—Å—ã–ª–∫–µ (https://drive.google.com/drive/folders/1GwC-4JUy53NoRdtl9XR2AZSEdwjQx89R?usp=sharing) –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤:

```text
work/weights/seg_best.pt
```

–ü—Ä–∏–º–µ—Ä:

```bash
mkdir -p work/weights
# —Å–∫–∞—á–∞–π—Ç–µ seg_best.pt –∏ –ø–æ–ª–æ–∂–∏—Ç–µ –≤ work/weights –≤—Ä—É—á–Ω—É—é
```

---

## üöÄ Inference (–∑–∞–ø—É—Å–∫ –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏)

1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (`.png`) –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –≤:

```text
data/test_images/
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å:

```bash
python src/infer_seg.py
```

3. –ì–æ—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤:

```text
work/runs/
```

4. –°–∫—Ä–∏–ø—Ç —Ç–∞–∫–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç –∞—Ä—Ö–∏–≤ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏:

```text
predict_target.zip
```

---

## üìä –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

–û–∂–∏–¥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:

```text
data/
‚îú‚îÄ‚îÄ train_images/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ train_masks/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ val_images/
‚îÇ   ‚îú‚îÄ‚îÄ 0.png
‚îÇ   ‚îú‚îÄ‚îÄ 1.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ val_masks/
    ‚îú‚îÄ‚îÄ 0.png
    ‚îú‚îÄ‚îÄ 1.png
    ‚îî‚îÄ‚îÄ ...
```

- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≤ `train_images` –∏ `train_masks` –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123.png` –∏ —Ç–∞–º, –∏ —Ç–∞–º).  
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è `val_images` / `val_masks`.  
- –ú–∞—Å–∫–∏ ‚Äî –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω—ã–µ (`uint8`), –≥–¥–µ –ø–∏–∫—Å–µ–ª–∏ = –∏–Ω–¥–µ–∫—Å—ã –∫–ª–∞—Å—Å–æ–≤ –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ.

---

## üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:

```bash
python src/train_seg.py
```

–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –æ–±—É—á–µ–Ω–∏—è:

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/train_images`, `data/train_masks`, `data/val_images`, `data/val_masks`
- –°—Ç—Ä–æ–∏—Ç –º–æ–¥–µ–ª—å **DeepLabV3+ (ResNet50)** —á–µ—Ä–µ–∑ `segmentation-models-pytorch`
- –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω CUDA)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç –ø–æ –º–µ—Ç—Ä–∏–∫–µ IoU –≤:

```text
work/weights/seg_best.pt
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —á–µ—Ä–µ–∑ `src/infer_seg.py`.

---


